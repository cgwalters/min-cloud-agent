Name:           min-metadata-service
Version:        2014.1
Release:        1%{?dist}
Summary:        Minimal metadata service
Group:          System Environment/Base
License:        GPLv2+
URL:            https://github.com/cgwalters/rpm-ostree
Source0:        %{name}-%{version}.tar.xz
BuildRequires: autoconf automake libtool
BuildRequires: pkgconfig(gio-unix-2.0)
BuildRequires: pkgconfig(libgsystem)
BuildRequires: pkgconfig(libsoup-2.4)

%description
Client implementation of a small subset of the AWS metadata service API.

%prep
%setup -q

%build
env NOCONFIGURE=1 ./autogen.sh
%configure
make %{?_smp_mflags}

%install
rm -rf $RPM_BUILD_ROOT
make install INSTALL='install -p' DESTDIR=$RPM_BUILD_ROOT
find $RPM_BUILD_ROOT -name '*.la' -exec rm -f {} ';'

%clean
rm -rf $RPM_BUILD_ROOT

%post
%systemd_post min-metadata.service

%preun
%systemd_preun min-metadata.service

%files
%defattr(-,root,root,-)
%doc COPYING
%{_libexecdir}/min-metadata-service
%{_prefix}/lib/systemd/system/min-metadata.service
